@model OnlineProdajaKarata.Models.Manifestacija

@{
    ViewData["Title"] = "Details";
    var kupljenaMjesta = ViewBag.KupljenaMjesta;
}

<h1>Kupi</h1>

<div>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.NazivManifestacije)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.NazivManifestacije)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.DatumVrijeme)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.DatumVrijeme)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Kategorija)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Kategorija)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.MjestoOdrzavanja)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.MjestoOdrzavanja)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.TrajanjeManifestacije)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.TrajanjeManifestacije)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.OpisManifestacije)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.OpisManifestacije)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.CijenaKarte)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.CijenaKarte)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Slika)
        </dt>
        <dd class="col-sm-10">
            <img src="@Model.Slika" alt="Greska" width="200" />
        </dd>
        <dt>
            <table style="border-collapse: collapse;">
                <tr>
                    <td style="padding: 5px;"></td>
                    @for (int k = 1; k <= 30; k++)
                    {
                        <td style="padding: 5px; font-weight: bold;">@k</td>
                    }
                </tr>
                @for (int i = 1; i <= 30; i++)
                {
                    <tr>
                        <td style="padding: 5px; font-weight: bold;">@i</td>
                        @for (int j = 1; j <= 30; j++)
                        {
                            var isKupljeno = false;
                            foreach (var mjesto in kupljenaMjesta)
                            {
                                if (mjesto.BrojReda == i && mjesto.BrojKolone == j)
                                {
                                    isKupljeno = true;
                                    break;
                                }
                            }
                            <td style="width: 30px; height: 30px; text-align: center; border: 1px solid black; padding: 5px; background-color: @(isKupljeno ? "#FFA07A" : "#90EE90");">@Html.Raw(isKupljeno ? "X" : "O")</td>
                        }
                    </tr>
                }
            </table>
        </dt>
        <form asp-action="KupiKartu" asp-controller="Manifestacija" method="post">
        <input type="hidden" name="ManifestacijaId" value="@Model.IDManifestacije" />
            <div style="margin-top: 20px; margin-bottom: 20px;">
            <label for="brojReda">Unesite red sjedista:</label>
                <input type="number" id="brojReda" name="brojReda" style="margin-right: 20px;" min="1" max="30" required>
            <label for="brojKolone">Unesite kolonu sjedista:</label>
            <input type="number" id="brojKolone" name="brojKolone" min="1" max="30" required>
        </div>
            <button type="submit" style="width: 100%; padding: 10px; font-size: 16px; margin-bottom: 20px;">Kupi kartu</button>
        </form>
        
    </dl>
</div>

<div>
    @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
    {
        <a asp-action="Edit" asp-route-id="@Model?.IDManifestacije">Izmjeni</a>
        <nobr>|</nobr>
    }
    <a asp-action="Index">Nazad</a>
</div>
